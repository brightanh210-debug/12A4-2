<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üéÅ Nh√¢n ng√†y 20/10 xin t·∫∑ng c√°c b·∫°n n·ªØ 12A4üòò</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="wrap">
  <header>
    <h1>üéÅ D√†nh t·∫∑ng cho c√°c b·∫°n n·ªØ 12A4</h1>
    <p class="lead">Nh·∫≠p t√™n v√† m·∫≠t kh·∫©u ƒë·ªÉ m·ªü m√≥n qu√† nh√©.</p>
  </header>

  <main class="card">
    <div class="form-row" id="formRow">
      <input id="name" type="search" placeholder="G√µ t√™n (v√≠ d·ª•: D∆∞∆°ng Nh·∫≠t Anh)" autocomplete="off">
      <input id="pass" type="password" placeholder="M·∫≠t kh·∫©u ">
      
      <button id="btn" class="btn">M·ªü qu√†</button>
    </div>
    <div id="suggestions" class="suggestions"></div>

    <section id="profile" class="profile hidden" aria-hidden="true">
      <div class="profile-cover" id="profileCover">
        <div class="profile-header">
          <h2 id="pname"></h2>
          <div class="meta">L·ªõp 12A4 ‚Äî Tr∆∞·ªùng THPT L√™ Qu√Ω ƒê√¥n<br>Ch·ªß nhi·ªám: Nguy·ªÖn Thanh T√¢m</div>
        </div>
      </div>
      <div class="profile-card" id="profileCard">
        <div class="poem-wrap">
          <h3>üíå L·ªùi ch√∫c</h3>
          <div id="poem" class="poem"></div>
        </div>
        <div id="videoBox" class="videoBox"></div>
        <button id="copyLink" class="mini">Copy link c√° nh√¢n</button>
        <div class="note">M·∫≠t kh·∫©u : <strong>C√°c b·∫°n nam 12A4 ƒë·∫πp trai</strong></div>
        <a id="back" class="back">‚Üê Quay l·∫°i</a>
      </div>
    </section>
  </main>

  <footer>Made with ‚ù§Ô∏è ‚Äî L·ªõp 12A4</footer>
</div>

<script>
const PASSWORD = "C√°c b·∫°n nam 12A4 ƒë·∫πp trai";
const PROFILES = [
  {
    "id": "duong-linh-anh",
    "name": "D∆∞∆°ng Linh Anh",
    "poem": "Anh ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Anh m·ªói ng√†y th√™m r·∫°ng r·ª°, \nng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFD6E8"
  },
  {
    "id": "nguyen-ngoc-linh-giang",
    "name": "Nguy·ªÖn Ng·ªçc Linh Giang",
    "poem": "Giang ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Giang m·ªói ng√†y th√™m r·∫°ng r·ª°, \nng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFE7C7"
  },
  {
    "id": "nguyen-thanh-hang",
    "name": "Nguy·ªÖn Thanh H·∫±ng",
    "poem": "H·∫±ng ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c H·∫±ng m·ªói ng√†y th√™m r·∫°ng r·ª°, \nng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFF3B0"
  },
  {
    "id": "phan-thi-my-hanh",
    "name": "Phan Th·ªã M·ªπ H·∫°nh",
    "poem": "H·∫°nh ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c H·∫°nh m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#D8FFD6"
  },
  {
    "id": "phan-thi-thanh-huyen",
    "name": "Phan Th·ªã Thanh Huy·ªÅn",
    "poem": "Huy·ªÅn ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Huy·ªÅn m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#D7F0FF"
  },
  {
    "id": "duong-thi-phuong-linh",
    "name": "D∆∞∆°ng Th·ªã Ph∆∞∆°ng Linh",
    "poem": "Linh ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Linh m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E8D7FF"
  },
  {
    "id": "ha-thi-linh",
    "name": "H√† Thi Linh",
    "poem": "Linh ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Linh m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFDDE1"
  },
  {
    "id": "hoang-ha-linh",
    "name": "Ho√†ng H√† Linh",
    "poem": "Linh ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Linh m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FEE2F2"
  },
  {
    "id": "nguyen-ngoc-khanh-ly",
    "name": "Nguy·ªÖn Ng·ªçc Kh√°nh Ly",
    "poem": "Ly ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ly m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFECEC"
  },
  {
    "id": "duong-phan-thao-mi",
    "name": "D∆∞∆°ng Phan Th·∫£o Mi",
    "poem": "Mi ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Mi m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFF0D6"
  },
  {
    "id": "pham-hoang-my",
    "name": "Ph·∫°m Ho√†ng My",
    "poem": "My ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c My m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E6FFE6"
  },
  {
    "id": "phan-thi-thuy-ngan",
    "name": "Phan Th·ªã Th√πy Ng√¢n",
    "poem": "Ng√¢n ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ng√¢n m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E6F7FF"
  },
  {
    "id": "duong-hoang-khanh-ngoc",
    "name": "D∆∞∆°ng Ho√†ng Kh√°nh Ng·ªçc",
    "poem": "Ng·ªçc ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ng·ªçc m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#F1E6FF"
  },
  {
    "id": "nguyen-thanh-bao-ngoc",
    "name": "Nguy·ªÖn Thanh B·∫£o Ng·ªçc",
    "poem": "Ng·ªçc ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ng·ªçc m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FDE8E8"
  },
  {
    "id": "vu-nhu-ngoc",
    "name": "V≈© Nh∆∞ Ng·ªçc",
    "poem": "Ng·ªçc ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ng·ªçc m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFE6F2"
  },
  {
    "id": "duong-thao-nguyen",
    "name": "D∆∞∆°ng Th·∫£o Nguy√™n",
    "poem": "Nguy√™n ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Nguy√™n m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFF7E6"
  },
  {
    "id": "pham-thi-anh-nguyet",
    "name": "Ph·∫°m Th·ªã Anh Nguy·ªát",
    "poem": "Nguy·ªát ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Nguy·ªát m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FDEFFB"
  },
  {
    "id": "pham-thi-thanh-nhan",
    "name": "Ph·∫°m Th·ªã Thanh Nh√£n",
    "poem": "Nh√£n ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Nh√£n m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E8FFF4"
  },
  {
    "id": "ho-thi-uyen-nhi",
    "name": "H·ªì Th·ªã Uy·ªÉn Nhi",
    "poem": "Nhi ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Nhi m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFF1F0"
  },
  {
    "id": "ton-nu-uyen-nhi",
    "name": "T√¥n N·ªØ Uy·ªÉn Nhi",
    "poem": "Nhi ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Nhi m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#EAF7FF"
  },
  {
    "id": "tran-ngoc-yen-nhi",
    "name": "Tr·∫ßn Ng·ªçc Y·∫øn Nhi",
    "poem": "Nhi ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Nhi m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFEFE6"
  },
  {
    "id": "phan-thi-ha-ni",
    "name": "Phan Th·ªã H√† Ni",
    "poem": "Ni ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ni m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFF0F6"
  },
  {
    "id": "nguyen-thi-kieu-oanh",
    "name": "Nguy·ªÖn Th·ªã Ki·ªÅu Oanh",
    "poem": "Oanh ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Oanh m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#EAF6E6"
  },
  {
    "id": "nguyen-hong-phuong",
    "name": "Nguy·ªÖn H·ªìng Ph∆∞∆°ng",
    "poem": "Ph∆∞∆°ng ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Ph∆∞∆°ng m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFEAD6"
  },
  {
    "id": "le-thi-ngoc-tam",
    "name": "L√™ Th·ªã Ng·ªçc T√¢m",
    "poem": "T√¢m ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c T√¢m m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#F3E6FF"
  },
  {
    "id": "vo-thi-my-tam",
    "name": "V√µ Th·ªã M·ªπ T√¢m",
    "poem": "T√¢m ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c T√¢m m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E6FFF9"
  },
  {
    "id": "nguyen-thi-hai-thuyet",
    "name": "Nguy·ªÖn Th·ªã H·∫£i Thuy·∫øt",
    "poem": "Thuy·∫øt ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Thuy·∫øt m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFF5EA"
  },
  {
    "id": "phan-hoai-thuong",
    "name": "Phan Ho√†i Th∆∞∆°ng",
    "poem": "Th∆∞∆°ng ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Th∆∞∆°ng m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FFEAF0"
  },
  {
    "id": "le-thi-hoai-trang",
    "name": "L√™ Th·ªã Ho√†i Trang",
    "poem": "Trang ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Trang m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E9F0FF"
  },
  {
    "id": "nguyen-huyen-trang",
    "name": "Nguy·ªÖn Huy·ªÅn Trang",
    "poem": "Trang ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c Trang m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FDF0E6"
  },
  {
    "id": "nguyen-thi-cam-tu",
    "name": "Nguy·ªÖn Thi C·∫©m T√∫",
    "poem": "T√∫ ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c T√∫ m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#E6FFF0"
  },
  {
    "id": "nguyen-thanh-tam",
    "name": "Nguy·ªÖn Thanh T√¢m",
    "poem": "T√¢m ∆°i, n·ª• c∆∞·ªùi nh∆∞ n·∫Øng s·ªõm,\n√Ånh nh√¨n d·ªãu d√†ng, xua tan m√πa m∆∞a.\nCh√∫c T√¢m m·ªói ng√†y th√™m r·∫°ng r·ª°, ng·∫≠p tr√†n y√™u th∆∞∆°ng.",
    "video": "",
    "color": "#FBEFFB"
  }
];

function normalize(s){
  if(!s) return "";
  s = s.toLowerCase();
  const map = {'√†':'a','√°':'a','·∫°':'a','·∫£':'a','√£':'a','√¢':'a','·∫ß':'a','·∫•':'a','·∫≠':'a','·∫©':'a','·∫´':'a','ƒÉ':'a','·∫±':'a','·∫Ø':'a','·∫∑':'a','·∫≥':'a','·∫µ':'a',
               '√®':'e','√©':'e','·∫π':'e','·∫ª':'e','·∫Ω':'e','√™':'e','·ªÅ':'e','·∫ø':'e','·ªá':'e','·ªÉ':'e','·ªÖ':'e',
               '√¨':'i','√≠':'i','·ªã':'i','·ªâ':'i','ƒ©':'i',
               '√≤':'o','√≥':'o','·ªç':'o','·ªè':'o','√µ':'o','√¥':'o','·ªì':'o','·ªë':'o','·ªô':'o','·ªï':'o','·ªó':'o','∆°':'o','·ªù':'o','·ªõ':'o','·ª£':'o','·ªü':'o','·ª°':'o',
               '√π':'u','√∫':'u','·ª•':'u','·ªß':'u','≈©':'u','∆∞':'u','·ª´':'u','·ª©':'u','·ª±':'u','·ª≠':'u','·ªØ':'u',
               '·ª≥':'y','√Ω':'y','·ªµ':'y','·ª∑':'y','·ªπ':'y','ƒë':'d'};
  let out = "";
  for(const ch of s) out += map[ch] || ch;
  out = out.replace(/[^\w\s-]/g,"").replace(/\s+/g," ").trim();
  return out.replace(/\s+/g,'').toLowerCase();
}

// Levenshtein distance for fuzzy
function levenshtein(a,b){
  if(a===b) return 0;
  const al = a.length, bl = b.length;
  if(al===0) return bl;
  if(bl===0) return al;
  const dp = Array(al+1).fill(null).map(()=>Array(bl+1).fill(0));
  for(let i=0;i<=al;i++) dp[i][0]=i;
  for(let j=0;j<=bl;j++) dp[0][j]=j;
  for(let i=1;i<=al;i++){
    for(let j=1;j<=bl;j++){
      const cost = a[i-1]===b[j-1]?0:1;
      dp[i][j] = Math.min(dp[i-1][j]+1, dp[i][j-1]+1, dp[i-1][j-1]+cost);
    }
  }
  return dp[al][bl];
}

function passwordAccepts(input){
  const nInput = normalize(input);
  const nPass = normalize(PASSWORD);
  if(nInput === nPass) return true;
  const d = levenshtein(nInput, nPass);
  const ratio = d / Math.max(nInput.length, nPass.length);
  return (d <= 2) || (ratio <= 0.18);
}

function buildLookup(){
  return PROFILES.map(p => ({...p, norm: normalize(p.name), id: p.id}));
}

const lookup = buildLookup();

function renderSuggestions(q){
  const el = document.getElementById('suggestions');
  el.innerHTML = "";
  if(!q) return;
  const nq = normalize(q);
  const matched = lookup.filter(p => p.norm.includes(nq) || p.id.includes(nq)).slice(0,8);
  if(matched.length===0){
    el.innerHTML = "<div class='sug'>Kh√¥ng t√¨m th·∫•y. Th·ª≠ g√µ kh√¥ng d·∫•u ho·∫∑c m·ªôt ph·∫ßn t√™n.</div>";
    return;
  }
  for(const p of matched){
    const d = document.createElement('div');
    d.className='sug';
    d.textContent = p.name;
    d.onclick = ()=>{ document.getElementById('name').value = p.name; el.innerHTML=''; };
    el.appendChild(d);
  }
}

const nameInput = document.getElementById('name');
const passInput = document.getElementById('pass');
const btn = document.getElementById('btn');
const profile = document.getElementById('profile');
const pname = document.getElementById('pname');
const poemEl = document.getElementById('poem');
const videoBox = document.getElementById('videoBox');
const copyBtn = document.getElementById('copyLink');
const back = document.getElementById('back');
const profileCover = document.getElementById('profileCover');
const profileCard = document.getElementById('profileCard');
const formRow = document.getElementById('formRow');
const suggestions = document.getElementById('suggestions');

nameInput.addEventListener('input', e=> renderSuggestions(e.target.value));
nameInput.addEventListener('keydown', e=> { if(e.key==='Enter') passInput.focus(); });
passInput.addEventListener('keydown', e=> { if(e.key==='Enter') doOpen(); });
btn.addEventListener('click', doOpen);

function findUserByName(q){
  const nq = normalize(q);
  return lookup.find(p => p.norm === nq) || lookup.find(p => p.norm.includes(nq)) || lookup.find(p => p.id === nq.replace(/\s+/g,'-'));
}

function doOpen(){
  const nameQ = nameInput.value.trim();
  const passQ = passInput.value.trim();
  if(!nameQ){ alert("Nh·∫≠p t√™n ƒëi nh√©."); nameInput.focus(); return; }
  if(!passQ){ alert("Nh·∫≠p m·∫≠t kh·∫©u chung."); passInput.focus(); return; }

  if(!passwordAccepts(passQ)){ alert("Sai m·∫≠t kh·∫©u chung. G·ª£i √Ω: C√°c b·∫°n nam 12A4 ƒë·∫πp trai"); passInput.focus(); return; }

  const user = findUserByName(nameQ);
  if(!user){ alert("Kh√¥ng t√¨m th·∫•y t√™n. Th·ª≠ g√µ kh√¥ng d·∫•u ho·∫∑c m·ªôt ph·∫ßn t√™n."); return; }
  openProfile(user);
}

function openProfile(user){
  // hide form
  formRow.style.display = 'none';
  suggestions.innerHTML = '';
  // set header & cover color
  pname.textContent = user.name;
  document.getElementById('profileCover').style.background = user.color || '#fff0f6';
  // poem
  poemEl.innerHTML = "<pre>"+(user.poem || "")+"</pre>";
  // video
  videoBox.innerHTML = "";
  if(user.video){
    const y = user.video.match(/(youtu\.be\/|v=|\/shorts\/)([A-Za-z0-9_-]{4,})/);
    if(y){
      const id = user.video.includes('youtu') ? (user.video.includes('v=') ? (new URL(user.video).searchParams.get('v')) : user.video.split('/').pop()) : null;
      const src = id ? ("https://www.youtube.com/embed/"+id) : user.video;
      const iframe = document.createElement('iframe');
      iframe.src = src; iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture"; iframe.allowFullscreen = true;
      videoBox.appendChild(iframe);
    } else {
      const v = document.createElement('video'); v.controls = true;
      const s = document.createElement('source'); s.src = user.video; s.type = "video/mp4";
      v.appendChild(s); videoBox.appendChild(v);
    }
  }
  profile.classList.remove('hidden');
  profile.setAttribute('aria-hidden','false');
  location.hash = user.id;
}

copyBtn.addEventListener('click', async ()=>{
  const id = location.hash.replace('#','') || normalize(nameInput.value).replace(/\s+/g,'-');
  const url = location.origin + location.pathname + "#" + id;
  try{ await navigator.clipboard.writeText(url); copyBtn.textContent = "ƒê√£ copy ‚úì"; setTimeout(()=> copyBtn.textContent = "Copy link c√° nh√¢n", 1500); }
  catch(e){ alert("Kh√¥ng copy ƒë∆∞·ª£c t·ª± ƒë·ªông, m√†y copy th·ªß c√¥ng link tr√™n thanh ƒë·ªãa ch·ªâ nh√©."); }
});

back.addEventListener('click', ()=>{
  profile.classList.add('hidden');
  profile.setAttribute('aria-hidden','true');
  formRow.style.display = '';
  location.hash = "";
});

window.addEventListener('load', ()=>{
  const h = location.hash.replace('#','');
  if(!h) return;
  const u = lookup.find(x=> x.id===h || x.idNorm===h);
  if(u){ nameInput.value = u.name; renderSuggestions(u.name); openProfile(u); }
});
</script>
</body>
</html>
