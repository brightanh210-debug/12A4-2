<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ NhÃ¢n ngÃ y 20/10 xin táº·ng cÃ¡c báº¡n ná»¯ 12A4ğŸ˜˜</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="wrap">
  <header>
    <h1>ğŸ DÃ nh táº·ng cho cÃ¡c báº¡n ná»¯ 12A4</h1>
    <p class="lead">Nháº­p tÃªn vÃ  máº­t kháº©u Ä‘á»ƒ má»Ÿ mÃ³n quÃ  nhÃ©.</p>
  </header>

  <main class="card">
    <div class="form-row" id="formRow">
      <input id="name" type="search" placeholder="GÃµ tÃªn (vÃ­ dá»¥: DÆ°Æ¡ng Nháº­t Anh)" autocomplete="off">
      <input id="pass" type="password" placeholder="Máº­t kháº©u ">
      
      <button id="btn" class="btn">Má»Ÿ quÃ </button>
    </div>
    <div id="suggestions" class="suggestions"></div>

    <section id="profile" class="profile hidden" aria-hidden="true">
      <div class="profile-cover" id="profileCover">
        <div class="profile-header">
          <h2 id="pname"></h2>
          <div class="meta">Lá»›p 12A4 â€” TrÆ°á»ng THPT LÃª QuÃ½ ÄÃ´n<br>Chá»§ nhiá»‡m: Nguyá»…n Thanh TÃ¢m</div>
        </div>
      </div>
      <div class="profile-card" id="profileCard">
        <div class="poem-wrap">
          <h3>ğŸ’Œ Lá»i chÃºc</h3>
          <div id="poem" class="poem"></div>
        </div>
        <div id="videoBox" class="videoBox"></div>
        <button id="copyLink" class="mini">Copy link cÃ¡ nhÃ¢n</button>
        <div class="note">Máº­t kháº©u : <strong>CÃ¡c báº¡n nam 12A4 Ä‘áº¹p trai</strong></div>
        <a id="back" class="back">â† Quay láº¡i</a>
      </div>
    </section>
  </main>

  <footer>Made with â¤ï¸ â€” Lá»›p 12A4</footer>
</div>

<script>
const PASSWORD = "CÃ¡c báº¡n nam 12A4 Ä‘áº¹p trai";
const PROFILES = [
  {
    "id": "duong-linh-anh",
    "name": "DÆ°Æ¡ng Linh Anh",
    "poem": "Anh Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Anh má»—i ngÃ y thÃªm ráº¡ng rá»¡, \nngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFD6E8"
  },
  {
    "id": "nguyen-ngoc-linh-giang",
    "name": "Nguyá»…n Ngá»c Linh Giang",
    "poem": "Giang Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Giang má»—i ngÃ y thÃªm ráº¡ng rá»¡, \nngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFE7C7"
  },
  {
    "id": "nguyen-thanh-hang",
    "name": "Nguyá»…n Thanh Háº±ng",
    "poem": "Háº±ng Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Háº±ng má»—i ngÃ y thÃªm ráº¡ng rá»¡, \nngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFF3B0"
  },
  {
    "id": "phan-thi-my-hanh",
    "name": "Phan Thá»‹ Má»¹ Háº¡nh",
    "poem": "Háº¡nh Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Háº¡nh má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#D8FFD6"
  },
  {
    "id": "phan-thi-thanh-huyen",
    "name": "Phan Thá»‹ Thanh Huyá»n",
    "poem": "Huyá»n Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Huyá»n má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#D7F0FF"
  },
  {
    "id": "duong-thi-phuong-linh",
    "name": "DÆ°Æ¡ng Thá»‹ PhÆ°Æ¡ng Linh",
    "poem": "Linh Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Linh má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E8D7FF"
  },
  {
    "id": "ha-thi-linh",
    "name": "HÃ  Thi Linh",
    "poem": "Linh Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Linh má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFDDE1"
  },
  {
    "id": "hoang-ha-linh",
    "name": "HoÃ ng HÃ  Linh",
    "poem": "Linh Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Linh má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FEE2F2"
  },
  {
    "id": "nguyen-ngoc-khanh-ly",
    "name": "Nguyá»…n Ngá»c KhÃ¡nh Ly",
    "poem": "Ly Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Ly má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFECEC"
  },
  {
    "id": "duong-phan-thao-mi",
    "name": "DÆ°Æ¡ng Phan Tháº£o Mi",
    "poem": "Mi Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Mi má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFF0D6"
  },
  {
    "id": "pham-hoang-my",
    "name": "Pháº¡m HoÃ ng My",
    "poem": "My Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc My má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E6FFE6"
  },
  {
    "id": "phan-thi-thuy-ngan",
    "name": "Phan Thá»‹ ThÃ¹y NgÃ¢n",
    "poem": "NgÃ¢n Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc NgÃ¢n má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E6F7FF"
  },
  {
    "id": "duong-hoang-khanh-ngoc",
    "name": "DÆ°Æ¡ng HoÃ ng KhÃ¡nh Ngá»c",
    "poem": "Ngá»c Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Ngá»c má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#F1E6FF"
  },
  {
    "id": "nguyen-thanh-bao-ngoc",
    "name": "Nguyá»…n Thanh Báº£o Ngá»c",
    "poem": "Ngá»c Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Ngá»c má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FDE8E8"
  },
  {
    "id": "vu-nhu-ngoc",
    "name": "VÅ© NhÆ° Ngá»c",
    "poem": "Ngá»c Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Ngá»c má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFE6F2"
  },
  {
    "id": "duong-thao-nguyen",
    "name": "DÆ°Æ¡ng Tháº£o NguyÃªn",
    "poem": "NguyÃªn Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc NguyÃªn má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFF7E6"
  },
  {
    "id": "pham-thi-anh-nguyet",
    "name": "Pháº¡m Thá»‹ Anh Nguyá»‡t",
    "poem": "Nguyá»‡t Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Nguyá»‡t má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FDEFFB"
  },
  {
    "id": "pham-thi-thanh-nhan",
    "name": "Pháº¡m Thá»‹ Thanh NhÃ£n",
    "poem": "NhÃ£n Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc NhÃ£n má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E8FFF4"
  },
  {
    "id": "ho-thi-uyen-nhi",
    "name": "Há»“ Thá»‹ Uyá»ƒn Nhi",
    "poem": "Nhi Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Nhi má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFF1F0"
  },
  {
    "id": "ton-nu-uyen-nhi",
    "name": "TÃ´n Ná»¯ Uyá»ƒn Nhi",
    "poem": "Nhi Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Nhi má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#EAF7FF"
  },
  {
    "id": "tran-ngoc-yen-nhi",
    "name": "Tráº§n Ngá»c Yáº¿n Nhi",
    "poem": "Nhi Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Nhi má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFEFE6"
  },
  {
    "id": "phan-thi-ha-ni",
    "name": "Phan Thá»‹ HÃ  Ni",
    "poem": "Ni Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Ni má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFF0F6"
  },
  {
    "id": "nguyen-thi-kieu-oanh",
    "name": "Nguyá»…n Thá»‹ Kiá»u Oanh",
    "poem": "Oanh Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Oanh má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#EAF6E6"
  },
  {
    "id": "nguyen-hong-phuong",
    "name": "Nguyá»…n Há»“ng PhÆ°Æ¡ng",
    "poem": "PhÆ°Æ¡ng Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc PhÆ°Æ¡ng má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFEAD6"
  },
  {
    "id": "le-thi-ngoc-tam",
    "name": "LÃª Thá»‹ Ngá»c TÃ¢m",
    "poem": "TÃ¢m Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc TÃ¢m má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#F3E6FF"
  },
  {
    "id": "vo-thi-my-tam",
    "name": "VÃµ Thá»‹ Má»¹ TÃ¢m",
    "poem": "TÃ¢m Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc TÃ¢m má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E6FFF9"
  },
  {
    "id": "nguyen-thi-hai-thuyet",
    "name": "Nguyá»…n Thá»‹ Háº£i Thuyáº¿t",
    "poem": "Thuyáº¿t Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Thuyáº¿t má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFF5EA"
  },
  {
    "id": "phan-hoai-thuong",
    "name": "Phan HoÃ i ThÆ°Æ¡ng",
    "poem": "ThÆ°Æ¡ng Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc ThÆ°Æ¡ng má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FFEAF0"
  },
  {
    "id": "le-thi-hoai-trang",
    "name": "LÃª Thá»‹ HoÃ i Trang",
    "poem": "Trang Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Trang má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E9F0FF"
  },
  {
    "id": "nguyen-huyen-trang",
    "name": "Nguyá»…n Huyá»n Trang",
    "poem": "Trang Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc Trang má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FDF0E6"
  },
  {
    "id": "nguyen-thi-cam-tu",
    "name": "Nguyá»…n Thi Cáº©m TÃº",
    "poem": "TÃº Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc TÃº má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#E6FFF0"
  },
  {
    "id": "nguyen-thanh-tam",
    "name": "Nguyá»…n Thanh TÃ¢m",
    "poem": "TÃ¢m Æ¡i, ná»¥ cÆ°á»i nhÆ° náº¯ng sá»›m,\nÃnh nhÃ¬n dá»‹u dÃ ng, xua tan mÃ¹a mÆ°a.\nChÃºc TÃ¢m má»—i ngÃ y thÃªm ráº¡ng rá»¡, ngáº­p trÃ n yÃªu thÆ°Æ¡ng.",
    "video": "",
    "color": "#FBEFFB"
  }
];

function normalize(s){
  if(!s) return "";
  s = s.toLowerCase();
  const map = {'Ã ':'a','Ã¡':'a','áº¡':'a','áº£':'a','Ã£':'a','Ã¢':'a','áº§':'a','áº¥':'a','áº­':'a','áº©':'a','áº«':'a','Äƒ':'a','áº±':'a','áº¯':'a','áº·':'a','áº³':'a','áºµ':'a',
               'Ã¨':'e','Ã©':'e','áº¹':'e','áº»':'e','áº½':'e','Ãª':'e','á»':'e','áº¿':'e','á»‡':'e','á»ƒ':'e','á»…':'e',
               'Ã¬':'i','Ã­':'i','á»‹':'i','á»‰':'i','Ä©':'i',
               'Ã²':'o','Ã³':'o','á»':'o','á»':'o','Ãµ':'o','Ã´':'o','á»“':'o','á»‘':'o','á»™':'o','á»•':'o','á»—':'o','Æ¡':'o','á»':'o','á»›':'o','á»£':'o','á»Ÿ':'o','á»¡':'o',
               'Ã¹':'u','Ãº':'u','á»¥':'u','á»§':'u','Å©':'u','Æ°':'u','á»«':'u','á»©':'u','á»±':'u','á»­':'u','á»¯':'u',
               'á»³':'y','Ã½':'y','á»µ':'y','á»·':'y','á»¹':'y','Ä‘':'d'};
  let out = "";
  for(const ch of s) out += map[ch] || ch;
  out = out.replace(/[^\w\s-]/g,"").replace(/\s+/g," ").trim();
  return out.replace(/\s+/g,'').toLowerCase();
}

// Levenshtein distance for fuzzy
function levenshtein(a,b){
  if(a===b) return 0;
  const al = a.length, bl = b.length;
  if(al===0) return bl;
  if(bl===0) return al;
  const dp = Array(al+1).fill(null).map(()=>Array(bl+1).fill(0));
  for(let i=0;i<=al;i++) dp[i][0]=i;
  for(let j=0;j<=bl;j++) dp[0][j]=j;
  for(let i=1;i<=al;i++){
    for(let j=1;j<=bl;j++){
      const cost = a[i-1]===b[j-1]?0:1;
      dp[i][j] = Math.min(dp[i-1][j]+1, dp[i][j-1]+1, dp[i-1][j-1]+cost);
    }
  }
  return dp[al][bl];
}

function passwordAccepts(input){
  const nInput = normalize(input);
  const nPass = normalize(PASSWORD);
  if(nInput === nPass) return true;
  const d = levenshtein(nInput, nPass);
  const ratio = d / Math.max(nInput.length, nPass.length);
  return (d <= 2) || (ratio <= 0.18);
}

function buildLookup(){
  return PROFILES.map(p => ({...p, norm: normalize(p.name), id: p.id}));
}

const lookup = buildLookup();

function renderSuggestions(q){
  const el = document.getElementById('suggestions');
  el.innerHTML = "";
  if(!q) return;
  const nq = normalize(q);
  const matched = lookup.filter(p => p.norm.includes(nq) || p.id.includes(nq)).slice(0,8);
  if(matched.length===0){
    el.innerHTML = "<div class='sug'>KhÃ´ng tÃ¬m tháº¥y. Thá»­ gÃµ khÃ´ng dáº¥u hoáº·c má»™t pháº§n tÃªn.</div>";
    return;
  }
  for(const p of matched){
    const d = document.createElement('div');
    d.className='sug';
    d.textContent = p.name;
    d.onclick = ()=>{ document.getElementById('name').value = p.name; el.innerHTML=''; };
    el.appendChild(d);
  }
}

const nameInput = document.getElementById('name');
const passInput = document.getElementById('pass');
const btn = document.getElementById('btn');
const profile = document.getElementById('profile');
const pname = document.getElementById('pname');
const poemEl = document.getElementById('poem');
const videoBox = document.getElementById('videoBox');
const copyBtn = document.getElementById('copyLink');
const back = document.getElementById('back');
const profileCover = document.getElementById('profileCover');
const profileCard = document.getElementById('profileCard');
const formRow = document.getElementById('formRow');
const suggestions = document.getElementById('suggestions');

nameInput.addEventListener('input', e=> renderSuggestions(e.target.value));
nameInput.addEventListener('keydown', e=> { if(e.key==='Enter') passInput.focus(); });
passInput.addEventListener('keydown', e=> { if(e.key==='Enter') doOpen(); });
btn.addEventListener('click', doOpen);

function findUserByName(q){
  const nq = normalize(q);
  return lookup.find(p => p.norm === nq) || lookup.find(p => p.norm.includes(nq)) || lookup.find(p => p.id === nq.replace(/\s+/g,'-'));
}

function doOpen(){
  const nameQ = nameInput.value.trim();
  const passQ = passInput.value.trim();
  if(!nameQ){ alert("Nháº­p tÃªn Ä‘i nhÃ©."); nameInput.focus(); return; }
  if(!passQ){ alert("Nháº­p máº­t kháº©u chung."); passInput.focus(); return; }

  if(!passwordAccepts(passQ)){ alert("Sai máº­t kháº©u chung. Gá»£i Ã½: CÃ¡c báº¡n nam 12A4 Ä‘áº¹p trai"); passInput.focus(); return; }

  const user = findUserByName(nameQ);
  if(!user){ alert("KhÃ´ng tÃ¬m tháº¥y tÃªn. Thá»­ gÃµ khÃ´ng dáº¥u hoáº·c má»™t pháº§n tÃªn."); return; }
  openProfile(user);
}

function openProfile(user){
  // hide form
  formRow.style.display = 'none';
  suggestions.innerHTML = '';
  // set header & cover color
  pname.textContent = user.name;
  document.getElementById('profileCover').style.background = user.color || '#fff0f6';
  // poem
  poemEl.innerHTML = "<pre>"+(user.poem || "")+"</pre>";
  // video
  videoBox.innerHTML = "";
  if(user.video){
    const y = user.video.match(/(youtu\.be\/|v=|\/shorts\/)([A-Za-z0-9_-]{4,})/);
    if(y){
      const id = user.video.includes('youtu') ? (user.video.includes('v=') ? (new URL(user.video).searchParams.get('v')) : user.video.split('/').pop()) : null;
      const src = id ? ("https://www.youtube.com/embed/"+id) : user.video;
      const iframe = document.createElement('iframe');
      iframe.src = src; iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture"; iframe.allowFullscreen = true;
      videoBox.appendChild(iframe);
    } else {
      const v = document.createElement('video'); v.controls = true;
      const s = document.createElement('source'); s.src = user.video; s.type = "video/mp4";
      v.appendChild(s); videoBox.appendChild(v);
    }
  }
  profile.classList.remove('hidden');
  profile.setAttribute('aria-hidden','false');
  location.hash = user.id;
}

copyBtn.addEventListener('click', async ()=>{
  const id = location.hash.replace('#','') || normalize(nameInput.value).replace(/\s+/g,'-');
  const url = location.origin + location.pathname + "#" + id;
  try{ await navigator.clipboard.writeText(url); copyBtn.textContent = "ÄÃ£ copy âœ“"; setTimeout(()=> copyBtn.textContent = "Copy link cÃ¡ nhÃ¢n", 1500); }
  catch(e){ alert("KhÃ´ng copy Ä‘Æ°á»£c tá»± Ä‘á»™ng, mÃ y copy thá»§ cÃ´ng link trÃªn thanh Ä‘á»‹a chá»‰ nhÃ©."); }
});

back.addEventListener('click', ()=>{
  profile.classList.add('hidden');
  profile.setAttribute('aria-hidden','true');
  formRow.style.display = '';
  location.hash = "";
});

window.addEventListener('load', ()=>{
  const h = location.hash.replace('#','');
  if(!h) return;
  const u = lookup.find(x=> x.id===h || x.idNorm===h);
  if(u){ nameInput.value = u.name; renderSuggestions(u.name); openProfile(u); }
});
</script>
</body>
</html>
